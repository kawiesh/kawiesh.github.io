<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="Simple notepad with clipboard and option to save note as txt file!"/>
<meta name="keywords" content="kawiesh, Notepad, txt file, txt"/>
<meta name="author" content="Kawiesh"/>

<meta name="theme-color" content="#889bb3">
<meta name="msapplication-TileColor" content="#da532c"/>
<meta name="msapplication-navbutton-color" content="#889bb3"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="msapplication-config" content="/resources/favicon/browserconfig.xml">

<link rel="apple-touch-icon" sizes="180x180" href="/resources/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/resources/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/resources/favicon/favicon-16x16.png">
<link rel="manifest" href="/resources/favicon/site.webmanifest">
<link rel="mask-icon" href="/resources/favicon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/resources/favicon/favicon1.ico">
<title>Notepad</title>

<style>
/* Design inspired by predic8 GmbH http://www.predic8.de */

*{
box-sizing: border-box;
margin: 0; padding:0;
outline: none;
}


html,body{
width: 100vw;
overflow-x: hidden;
}


body{
position: relative;
background: url(/resources/bg.png);
color: #4c566c;
font: normal 12px Arial;
text-align: center;
text-shadow: 0px 1px -1px #fff;
-webkit-tap-highlight-color: transparent;
}

/*------TOP BAR-----------*/
#topbar{
background-image: -webkit-gradient(linear, left top, left bottom, 
from(#b4bfce), color-stop( 50%, #889bb3), color-stop(50%, #7f94b0), to(#6d83a1));
border-bottom: 1px solid black;
width: 100%;
height: 40px;
display: flex;
justify-content: space-between;
align-items: center;		
padding: 0 5px;		
}

#topbar>*{
display: flex;
justify-content: center;
align-items: center;				
}


h1{
font-size: 20px;
text-shadow: 0px -1px 1px #000;
color: white;
}

.button{
-webkit-box-shadow: 0px -1px 1px #2f3740, 0px 1px 1px #bfcbdb;
background-image: -webkit-gradient(linear, left top, left bottom, 
from(#8aa1bf), color-stop( 50%, #5877a2), color-stop(50%, #476999), to(#4a6c9b));
border: 1px solid #3e444c;
-webkit-border-radius: 4px;
z-index: 3;
width: 30px;
height: 30px;
padding: 5px;
color: white;
}

.button>svg{
fill: white;
width: 100%;
height: 100%;				
}


#tools{
left: 6px;
}

#settings{
right: 6px;							
}



/*------SIDEBAR-----------*/
.sidebar{
position: absolute;
width: 50%; height: 100%;
top:0;
z-index: 2;
background: rgb(176,196,222,0.7);
transition: .5s linear;
border: 1px solid black;
border-radius: 12px;
}

.sidebar.left{
left:-55%;
border-top-left-radius: 0px;	
border-bottom-left-radius: 0px;						
}

.sidebar.right{
right:-55%;			
border-top-right-radius: 0px;	
border-bottom-right-radius: 0px;		
}



.sidebar.left.open{
left: 0; 								
}

.sidebar.right.open{
right: 0;								
}




h2{
text-align: left;
text-transform: lowercase;
font: small-caps bold 14px Arial;
margin: 12px 0 0 12px;
}

#main h2{ margin: 5px 0 0 0; }
.sidebar>h2:first-child{ margin-top: 40px;}



/*------MAIN BODY-----------*/
#main{
margin: 0 10px;	
width: calc(100% - 20px);
display: flex;
flex-direction: column;				
}





#title, #notepad{
width: 100%;
padding: 5px;	
border: 1px solid black;			
border-radius: 5px;
font-size: 15px;
}


#title{
font-weight: bold;
height: 40px;		
}

#notepad{
height: 600px;
margin: 5px 0;		
}

.lastblock{
margin-bottom: 10px;
display: flex;
justify-content: space-between;							
}

#clear, #save{
text-transform: lowercase;
font: small-caps bold 15px Arial;
width: 50px;
padding: 2px;
display: flex;
justify-content: center;
align-items: center;
}







.ls,.rs{
background-color: white;
border: 1px solid black;
border-radius: 5px;
width: calc(100% - 30px);
padding: 5px;
margin: 0 10px;
display: flex;
justify-content: space-between;
align-items: center;
}


.clipboard.ls,
.fontstyle.rs{
justify-content: space-between;
align-items: center;
}


.clipboard.ls>div,
.fontstyle.rs>div{
display: flex;
justify-content: flex-start;
align-items: center;
height: 20px;
width: 100%;		
}



.textarea.ls{
margin-top: 10px;
height: 320px;
flex-direction: column;
justify-content: space-between;
align-items: center;
position: relative;					
}


.info.ls{
margin-top: 10px;
padding: 5px;
text-align: left;	
font: bold 10px "Courier New";	
}



.textarea.ls>textarea{
width: 100%;
height: 100px;	
padding: 5px;
border: 1px solid black;	
border-radius: 2px;
}

/*
.textarea.ls::after{
content:"Unlock to edit fields \A Lock and click on fields to paste";
position: absolute;
bottom: -5px;
width: 100%;				
}*/



.cb{
display: inline-block;
height: 100%; width: 20px;
border: 1px solid black;	
border-radius: 2px;						
}


#increase, #decrease{
width: 30px;
height: 30px;
cursor: pointer;								
}

.rs svg{
width: 100%;
height: 100%;
opacity: 0.5;				
}


.hover{
background: yellow;						
}



#fontfamily{
width: 100%;
height: 40px;						
}


#fontcolor, #bgcolor{
width: 30px;
height: 30px;								
}

#fontcolor + input,
#bgcolor + input{
width: calc(100% - 35px);				
height: 30px;
padding: 5px;			
}



#notepad.bold{ font-weight: bold;}
#notepad.italic{ font-style: italic;}

</style>
</head>
<body>

<div id="topbar">
  <div class="button fixed" id="tools">+</div>
  <h1>Notepad</h1>
  <div class="button fixed" id="settings">+</div>
</div>


<section id="main">

<h2>Title</h2>
<input type="text" id="title">
<textarea id="notepad"></textarea>
<div class="lastblock">
  <div class="button" id="clear">Clear</div>
  <div class="button" id="save">Save</div>
</div>
</section>


<!-- LEFT SIDEBAR -->
<div class="sidebar left fixed">
<h2>Clipboard</h2>

<div class="clipboard ls">
<div><span class="locked cb"></span>&nbsp;Lock</div>
<div><span class="unlocked cb readonly"></span>&nbsp;Unlock</div>
</div>

<div class="textarea ls">
<textarea></textarea>
<textarea></textarea>
<textarea></textarea>
</div>

<div class="info ls">When a field is locked,
click on it to paste its content
into the notepad field
<br><br>Use lock/unlock to lock/edit fields
</div>

</div>


<!-- RIGHT SIDEBAR -->
<div class="sidebar right fixed">

<h2>Font size</h2>
<div class="fontsize rs">
<div id="decrease">-</div>
<div id="fontsize">15 px</div>
<div id="increase">+</div>
</div>

<h2>Font family</h2>
<div class="fontfamily rs">
<select id="fontfamily">
<option>Arial</option>
<option>Cursive</option>
<option>Georgia</option>
<option>Courier New</option>
<option>Times New Roman</option>
</select>				
</div>

<h2>Font style</h2>
<div class="fontstyle rs">
<div><span class="bold cb"></span>&nbsp;Bold</div>
<div><span class="italic cb"></span>&nbsp;Italic</div>
</div>

<h2>Font color</h2>
<div class="fontcolor rs">
<input type="color" id="fontcolor">
<input type="text">
</div>

<h2>Background color</h2>
<div class="bgcolor rs">
<input type="color" id="bgcolor">
<input type="text">
</div>

</div>
<script>
let create= (x)=> document.createElement(x),
select= (x,y=document)=> y.querySelector(x),
selectAll= (x,y=document)=> y.querySelectorAll(x);				


selectAll("body *").forEach(i=>{
i.dataset.nosnippet= true;
});



let minus= `<svg viewBox="0 0 64 64">
<path d="M2 26h60v12H2z"/>
</svg>`;			
					
let plus= `	
<svg viewBox="0 0 64 64">
<path d="M38 26V2H26v24H2v12h24v24h12V38h24V26z"/>
</svg>`;

let decr= `<svg viewBox="0 0 16 16"><g fill="black">
<path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 
1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 
2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
<path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 
1h-7A.5.5 0 0 1 4 8z"/></g>
</svg>`;



let incr= `<svg viewBox="0 0 16 16"><g fill="black">
<path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 
1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 
2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
<path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 
0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/></g>
</svg>`;


let decrease= select("#decrease"),
increase= select("#increase"),
fontsize= select("#fontsize");


decrease.innerHTML= decr;
increase.innerHTML= incr;


				
let buttons= selectAll(".button.fixed");
let sidebars= selectAll(".sidebar");


addEvent(buttons[0],sidebars[0]);
addEvent(buttons[1],sidebars[1]);


function addEvent(button,sidebar){
button.onclick= function(){
sidebar.classList.toggle("open");
if(sidebar.classList.contains("open")){
blur4me("3px","none",[button,sidebar]);
this.innerHTML= "-";	
this.innerHTML= minus;	
}
else{
blur4me("0","auto",[button,sidebar]);
this.innerHTML= "+";
this.innerHTML= plus;
}							
};

							
				
}//End





function blur4me(x,y,z){
selectAll("body>*:not(#topbar)").forEach(i=>{
i.style.filter= `blur(${x})`;
i.style.pointerEvents= y;
});


selectAll("#topbar>*").forEach(i=>{
i.style.filter= `blur(${x})`;
i.style.pointerEvents= y;							
});

z.forEach(i=>{
i.style.filter= "blur(0)";
i.style.pointerEvents= "auto";
});

}
					
				
buttons.forEach(i=>{				
i.innerHTML= plus;				
});


let
title= select("#title"),
notepad= select("#notepad"),
clear= select("#clear"),
save= select("#save");


clear.onclick=()=>{
notepad.value= "";				
};


save.onclick=()=>{
let a= notepad.value.replace(/\n/g, "\r\n"),
b= new Blob([a], { type: "text/plain"}),
c= create("a");
c.download= title.value||"My note" + ".txt";
c.href= window.URL.createObjectURL(b);
c.target="_blank";
c.style.display = "none";
document.body.append(c);
c.click(); c.remove();
};


/*________________________________________________*/

let _fontsize;

function adjustFont(x){
if(_fontsize < 6) _fontsize= 6;
_fontsize= _fontsize + x;
fontsize.innerHTML= _fontsize + "px";
notepad.style.fontSize= _fontsize+"px";				
}



let _timer;

decrease.ontouchstart= function(e){
this.classList.add("hover");
_timer= setInterval(()=>{
adjustFont(-1);
}, 50);
return false;
};


increase.ontouchstart= function(e){
this.classList.add("hover");
_timer= setInterval(()=>{
adjustFont(1);
}, 50);
return false;
};


document.body.ontouchend=()=>{
increase.classList.remove("hover");
decrease.classList.remove("hover");
clearInterval(_timer);
//return false;
};




/*________________________________________________*/
let boldcb= select(".bold.cb");
let italiccb= select(".italic.cb");

function checkBox(el,cl){
el.onclick= function(){
notepad.classList.toggle(cl);
this.style.background=
notepad.classList.contains(cl) ? "#8aa1bf" : "white";
};
}


checkBox(boldcb, "bold");
checkBox(italiccb, "italic");



/*________________________________________________*/
let fontfamily= select("#fontfamily");

fontfamily.onchange= function(){
let a= this.options[this.selectedIndex].innerHTML;
notepad.style.fontFamily= a;						
};


/*________________________________________________*/
function hex2rgb(hex){
let [r,g,b]= hex.match(/\w\w/g).map(x => parseInt(x, 16));
return `rgb(${r}, ${g}, ${b})`;
};


function rgb2hex(rgb){
let a= rgb.match(/\d+/g);
let b= [...a].map(i=>{
i= parseInt(i).toString(16);
return (i.length==1) ? "0"+i : i;
});

return "#" + b.join("");
}




let fontcolor= select("#fontcolor");
let bgcolor= select("#bgcolor");
let _fontcolor= fontcolor.nextElementSibling;
let _bgcolor= bgcolor.nextElementSibling;



function changeColors(a,b){
title.style.color= a;
notepad.style.color= a;
title.style.background= b;
notepad.style.background= b;	
}

fontcolor.oninput= function(){
_fontcolor.value= hex2rgb(this.value);
changeColors(_fontcolor.value, _bgcolor.value);
};


bgcolor.oninput= function(){
_bgcolor.value= hex2rgb(this.value);
changeColors(_fontcolor.value, _bgcolor.value);
};


_fontcolor.oninput= function(){
fontcolor.value= rgb2hex(this.value);
changeColors(_fontcolor.value, _bgcolor.value);
}

_bgcolor.oninput= function(){
bgcolor.value= rgb2hex(this.value);
changeColors(_fontcolor.value, _bgcolor.value);
}



/*________________________________________________*/
let _textarea= select(".textarea.ls");
let textareas= selectAll("textarea", _textarea);

function checkBoxCB(el1,el2,ro){
select(el1).onclick= function(){
this.classList.toggle("readonly");

if(this.classList.contains("readonly")){
this.style.background= "#8aa1bf"
textareas.forEach(i=> i.readOnly= ro);
select(el2).classList.remove("readonly");
select(el2).style.background= "white";
}
else return false;

};
}


select(".unlocked.cb").style.background= "#8aa1bf";

textareas.forEach(i=>{
i.readOnly= false;
i.onclick= function(){
if(this.readOnly){
if(notepad.setRangeText){notepad.setRangeText(this.value);}
else{
notepad.focus();
document.execCommand('insertText', false, this.value);
}				
}};
});

checkBoxCB(".locked.cb",".unlocked.cb",true);
checkBoxCB(".unlocked.cb",".locked.cb",false);



/*__________________________________________________*/
let savedData= localStorage.getItem("_store");
if(savedData) savedData= JSON.parse(savedData);

title.value= (savedData) ? savedData["_title"] : "";
notepad.value= (savedData) ? savedData["_notepad"] : "";
textareas[0].value= (savedData) ? savedData["_field0"] : "";
textareas[1].value= (savedData) ? savedData["_field1"] : "";
textareas[2].value= (savedData) ? savedData["_field2"] : "";

fontcolor.value= (savedData) ? savedData["_color"] : "#000000";
bgcolor.value= (savedData) ? savedData["_bgcolor"] : "#ffffd2"; 
_fontcolor.value= (savedData) ? hex2rgb(savedData["_color"]) : "rgb(0, 0, 0)";
_bgcolor.value= (savedData) ? hex2rgb(savedData["_bgcolor"]) : "rgb(255, 255, 210)";
title.style.color= notepad.style.color= _fontcolor.value;
title.style.background= notepad.style.background= _bgcolor.value;


_fontsize= (savedData) ? parseInt(savedData["_size"]) : 15;
notepad.style.fontSize= fontsize.innerHTML= (savedData) ? savedData["_size"] : "15px";
fontfamily.selectedIndex= (savedData) ? savedData["_family"] : 0;
notepad.style.fontFamily= fontfamily.options[fontfamily.selectedIndex].innerHTML;
notepad.className= (savedData) ? savedData["_style"] : "";
if(notepad.classList.contains("bold")) boldcb.style.background= (savedData) ? "#8aa1bf" : "#ffffff";
if(notepad.classList.contains("italic")) italiccb.style.background= (savedData) ? "#8aa1bf" : "#ffffff";




//-----------------
let obu = false;
window.onunload = window.onbeforeunload= function(){
if(!obu){
obu= true;

let _store= {
_title : title.value,
_notepad : notepad.value,
_field0 : textareas[0].value,
_field1 : textareas[1].value,
_field2 : textareas[2].value,
_color : fontcolor.value||"#000000",
_bgcolor : bgcolor.value||"#ffffff",
_size : fontsize.innerHTML,
_style : [...notepad.classList].join(" "),
_family : fontfamily.selectedIndex
};


localStorage.removeItem("_store");
localStorage.setItem("_store", JSON.stringify(_store));
}
};



</script>

</body>
</html>
